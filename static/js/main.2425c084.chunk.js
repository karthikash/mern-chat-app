(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{228:function(e,t,a){},232:function(e,t){},234:function(e,t){},248:function(e,t){},250:function(e,t){},278:function(e,t){},280:function(e,t){},281:function(e,t){},286:function(e,t){},288:function(e,t){},307:function(e,t){},319:function(e,t){},322:function(e,t){},465:function(e,t,a){"use strict";a.r(t);var s=a(1),n=a(2),r=a.n(n),c=a(77),o=a.n(c),i=a(19),l=a(20),d=a(22),j=a(21),h=(a(228),a(466)),m=a(467),u=a(468),b=a(491),O=a(492),p=a(493),g=a(469),f=a(470),x=a(471),v=a(79),P={REACT_APP_API_BASE_URL:"https://mern-chat-backend.herokuapp.com/v1",REACT_APP_JWT_SECRET_KEY:"keepitsecret",REACT_APP_SOCKET:"https://mern-chat-backend.herokuapp.com"},w=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).isAuth=function(){var e=localStorage.getItem("_id"),t=localStorage.getItem("token");return!(!e||!t)&&Object(v.verify)(t,P.REACT_APP_JWT_SECRET_KEY)._id===e},e.logout=function(){var e=localStorage.getItem("_id"),t=localStorage.getItem("token"),a={Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(t)},s={method:"POST",headers:new Headers(a)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/auth/logout/").concat(e),s).then((function(){localStorage.removeItem("_id"),localStorage.removeItem("token"),window.location.reload()})).catch((function(e){console.log("error: ",e)}))},e.deactivateAccount=function(){var e=localStorage.getItem("_id"),t=localStorage.getItem("token"),a={Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(t)},s={method:"DELETE",headers:new Headers(a)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/user/delete/").concat(e),s).then((function(){localStorage.removeItem("_id"),localStorage.removeItem("token"),window.location.reload()})).catch((function(e){console.log("error: ",e)}))},e}return Object(l.a)(a,[{key:"render",value:function(){if(this.isAuth()){var e=localStorage.getItem("dp");return Object(s.jsx)("div",{children:Object(s.jsxs)(h.a,{color:"faded",light:!0,expand:"md",children:[Object(s.jsx)(m.a,{href:"/chat",children:"Mern Chat App"}),Object(s.jsxs)(u.a,{className:"ml-auto",navbar:!0,children:[Object(s.jsxs)(b.a,{nav:!0,inNavbar:!0,children:[Object(s.jsx)(O.a,{nav:!0,caret:!0,children:"Account"}),Object(s.jsxs)(p.a,{right:!0,children:[Object(s.jsx)(g.a,{href:"/profile",children:"  Profile "}),Object(s.jsx)(g.a,{onClick:this.logout,children:" Logout "}),Object(s.jsx)(g.a,{href:"/reset",children:"Reset Password "}),Object(s.jsx)(g.a,{divider:!0}),Object(s.jsx)(g.a,{onClick:this.deactivateAccount,children:"  Deactivate Account   "})]})]}),Object(s.jsx)(f.a,{children:Object(s.jsx)(x.a,{className:"dp",src:e,alt:"Name"})})]})]})})}return Object(s.jsx)("div",{children:Object(s.jsx)(h.a,{color:"faded",light:!0,expand:"md",children:Object(s.jsx)(m.a,{href:"/chat",children:"Mern Chat App"})})})}}]),a}(n.Component),C=a(472),y=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){return Object(i.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return Object(s.jsx)("div",{children:Object(s.jsxs)(h.a,{color:"faded",light:!0,expand:"md",children:[Object(s.jsx)(u.a,{navbar:!0,children:Object(s.jsx)(C.a,{children:"Chat App \xa9 2020. All Rights Reserved"})}),Object(s.jsx)(u.a,{className:"ml-auto",navbar:!0,children:Object(s.jsxs)(C.a,{children:["Created by ",Object(s.jsx)("a",{href:"https://github.com/kpenhanced",rel:"noreferrer",target:"_blank",children:"Karthik Ashokkumar"})," "]})})]})})}}]),a}(n.Component),S=a(18),A=a.n(S),N=a(26),_=a(23),I=a(12),k=a(473),T=a(474),U=a(475),E=a(476),L=a(477),F=a(217),R=a(51),B=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).getInitialState=function(){return{data:{sFirstName:"",sLastName:"",sUsername:"",sPassword:"",sConfirmPassword:""},errors:{},response:{status:"",message:"",error:""}}},s.handleChange=function(e){s.setState({data:Object(I.a)(Object(I.a)({},s.state.data),{},Object(_.a)({},e.target.name,e.target.value)),errors:Object(I.a)(Object(I.a)({},s.state.errors),{},Object(_.a)({},e.target.name,""))})},s.validate=function(){var e=s.state.data,t={};return Object(R.isAlpha)(e.sFirstName)||(t.sFirstName="First name must only contain alphabets."),""===e.sFirstName&&(t.sFirstName="First name cannot be empty."),Object(R.isAlpha)(e.sLastName)||(t.sLastName="Last name must only contain alphabets."),""===e.sLastName&&(t.sLastName="Last name cannot be empty."),""===e.sUsername&&(t.sUsername="Username cannot be empty."),e.sPassword.length<8&&(t.sPassword="Password must be atleast 8 characters."),""===e.sPassword&&(t.sPassword="Password cannot be empty."),e.sPassword!==e.sConfirmPassword&&(t.sConfirmPassword="Passwords doesn't match."),e.sConfirmPassword.length<8&&(t.sConfirmPassword.sPassword="Password must be atleast 8 characters."),""===e.sConfirmPassword&&(t.sConfirmPassword="Password cannot be empty."),t},s.handleSubmit=function(e){e.preventDefault();var t=s.state.data,a=s.validate();if(0===Object.keys(a).length){delete t.sConfirmPassword;var n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},body:JSON.stringify(t)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/auth/signup"),n).then(function(){var e=Object(N.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:a=e.sent,s.setState({response:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error: ",e)})),s.setState(s.getInitialState())}else s.setState({errors:a})},s.state=s.getInitialState(),s}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.data,a=e.errors,n=e.response;return Object(s.jsxs)(k.a,{onSubmit:this.handleSubmit,children:[Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sFirstName",children:"First Name"}),Object(s.jsx)(E.a,{id:"sFirstName",name:"sFirstName",invalid:!!a.sFirstName,onChange:this.handleChange,value:t.sFirstName}),Object(s.jsx)(L.a,{children:a.sFirstName})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sLastName",children:"Last Name"}),Object(s.jsx)(E.a,{id:"sLastName",name:"sLastName",invalid:!!a.sLastName,onChange:this.handleChange,value:t.sLastName}),Object(s.jsx)(L.a,{children:a.sLastName})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sUsername",children:"Username"}),Object(s.jsx)(E.a,{id:"sUsername",name:"sUsername",invalid:!!a.sUsername,onChange:this.handleChange,value:t.sUsername}),Object(s.jsx)(L.a,{children:a.sUsername})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sPassword",children:"Password"}),Object(s.jsx)(E.a,{id:"sPassword",name:"sPassword",type:"password",invalid:!!a.sPassword,onChange:this.handleChange,value:t.sPassword}),Object(s.jsx)(L.a,{children:a.sPassword})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sConfirmPassword",children:"Confirm Password"}),Object(s.jsx)(E.a,{id:"sConfirmPassword",name:"sConfirmPassword",type:"password",invalid:!!a.sConfirmPassword,onChange:this.handleChange,value:t.sConfirmPassword}),Object(s.jsx)(L.a,{children:a.sConfirmPassword})]}),Object(s.jsx)(T.a,{children:n.message?n.status>400?Object(s.jsx)("div",{className:"alert alert-danger",children:n.message}):Object(s.jsx)("div",{className:"alert alert-success",children:n.message}):null}),Object(s.jsx)(T.a,{children:Object(s.jsx)(F.a,{color:"primary",block:!0,children:"Register"})})]})}}]),a}(n.Component),M=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).getInitialState=function(){return{data:{sUsername:"",sPassword:""},errors:{},response:{status:"",message:"",error:""}}},s.handleChange=function(e){s.setState({data:Object(I.a)(Object(I.a)({},s.state.data),{},Object(_.a)({},e.target.name,e.target.value)),errors:Object(I.a)(Object(I.a)({},s.state.errors),{},Object(_.a)({},e.target.name,""))})},s.validate=function(){var e=s.state.data,t={};return""===e.sUsername&&(t.sUsername="Username cannot be empty."),e.sPassword.length<8&&(t.sPassword="Password must be atleast 8 characters."),""===e.sPassword&&(t.sPassword="Password cannot be empty."),t},s.handleSubmit=function(e){e.preventDefault();var t=s.state.data,a=s.validate();if(0===Object.keys(a).length){var n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},credentials:"include",body:JSON.stringify(t)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/auth/signin"),n).then(function(){var e=Object(N.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,s.setState({response:a}),200!==a.status){e.next=8;break}return localStorage.setItem("_id",a._id),localStorage.setItem("token",a.token),e.abrupt("return",window.location.assign("/chat"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error: ",e)})),s.setState(s.getInitialState())}else s.setState({errors:a})},s.state=s.getInitialState(),s}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.data,a=e.errors,n=e.response;return Object(s.jsxs)(k.a,{onSubmit:this.handleSubmit,children:[Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sUsername",children:"Username"}),Object(s.jsx)(E.a,{id:"sUsername",name:"sUsername",invalid:!!a.sUsername,onChange:this.handleChange,value:t.sUsername}),Object(s.jsx)(L.a,{children:a.sUsername})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sPassword",children:"Password"}),Object(s.jsx)(E.a,{id:"sPassword",name:"sPassword",type:"password",invalid:!!a.sPassword,onChange:this.handleChange,value:t.sPassword}),Object(s.jsx)(L.a,{children:a.sPassword})]}),Object(s.jsx)(T.a,{children:n.message?n.status>400?Object(s.jsx)("div",{className:"alert alert-danger",children:n.message}):Object(s.jsx)("div",{className:"alert alert-success",children:n.message}):null}),Object(s.jsx)(T.a,{children:Object(s.jsx)(F.a,{color:"primary",block:!0,children:"Login"})})]})}}]),a}(n.Component),D=a(478),H=a(479),z=a(480),J=a(481),K=a(482),G=a(483),W=a(484),Y=a(485),V=a(82),q=a.n(V),Q=a(83),X=a.n(Q),Z=a(220),$=Object(Z.io)(P.REACT_APP_SOCKET),ee=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).autoscroll=function(){s.messagesEnd.scrollIntoView({behavior:"auto"})},s.getInitialState=function(){return{userList:[],errors:{},response:{status:"",message:"",error:""},selectedUser:{activeIndex:null,userId:"",name:"",username:"",dp:"",lastseen:""},chat:{message:""},files:{media:""},messages:[]}},s.handleChange=function(e){e.target.files?s.setState({files:{media:e.target.files[0]}}):s.setState({chat:Object(I.a)(Object(I.a)({},s.state.chat),{},Object(_.a)({},e.target.name,e.target.value))})},s.isActive=function(e,t){t&&t.userId?s.setState({selectedUser:{activeIndex:e,userId:t.userId,name:t.name,username:t.username,dp:t.dp,lastseen:t.lastseen}}):s.setState({selectedUser:{activeIndex:e,userId:t._id,name:"".concat(t.sFirstName," ").concat(t.sLastName),username:t.sUsername,dp:t.sImage,lastseen:t.createdAt}});var a=localStorage.getItem("_id"),n=localStorage.getItem("token"),r=t._id||t.userId,c={Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(n)},o={method:"GET",headers:new Headers(c)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/chat/list?sender=").concat(a,"&receiver=").concat(r),o).then(function(){var e=Object(N.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:a=e.sent,s.setState({messages:a.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error: ",e)}))},s.uploadButton=function(){q()("input[type=file]").trigger("click")},s.sendMessage=function(e){e.preventDefault();var t=s.state,a=t.chat,n=t.selectedUser,r=t.files,c=localStorage.getItem("_id"),o=localStorage.getItem("token");if(r&&r.media){var i=new FormData;i.append("oFrom",c),i.append("oTo",n.userId),i.append("media",r.media);var l={Authorization:"Bearer ".concat(o)},d={method:"POST",headers:new Headers(l),body:i};fetch("".concat(P.REACT_APP_API_BASE_URL,"/chat/upload"),d).then((function(e){s.setState({selectedUser:{activeIndex:n.activeIndex,userId:n.userId,name:n.name,username:n.username,dp:n.dp,lastseen:n.lastseen},files:{media:""}}),s.isActive(n.activeIndex,n),s.socket.emit("new_text_message",{sMessage:a.message,oFrom:c,oTo:n.userId})})).catch((function(e){console.log("error: ",e)}))}else{var j={Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(o)},h={method:"POST",headers:new Headers(j),body:JSON.stringify({sMessage:a.message,oFrom:c,oTo:n.userId})};fetch("".concat(P.REACT_APP_API_BASE_URL,"/chat/send"),h).then(function(){var e=Object(N.a)(A.a.mark((function e(t){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.setState({chat:{message:""}}),s.isActive(n.activeIndex,n),s.socket.emit("new_text_message",{sMessage:a.message,oFrom:c,oTo:n.userId});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error: ",e)}))}},s.isMessageTyped=function(){var e=s.state.chat.message,t=s.state.files.media;return!!(e&&e.length>0)||"object"===typeof t},s.state=s.getInitialState(),s.messagesEnd=Object(n.createRef)(),s.socket=$,s}return Object(l.a)(a,[{key:"componentDidUpdate",value:function(){this.autoscroll()}},{key:"componentDidMount",value:function(){var e=this;this.autoscroll(),this.socket.on("socket.id",(function(e){localStorage.setItem("socketid",e)})),this.socket.on("refresh_messages",(function(t){console.log(t);var a=localStorage.getItem("_id"),s=e.state.selectedUser;a===t?(e.isActive(s.activeIndex,s),e.socket.emit("receiver",!0)):e.socket.emit("receiver",!1)}));var t=localStorage.getItem("_id"),a=localStorage.getItem("token"),s={Authorization:"Bearer ".concat(a)},n={method:"GET",headers:new Headers(s)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/user/list?_id=").concat(t),n).then(function(){var t=Object(N.a)(A.a.mark((function t(a){var s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.json();case 2:s=t.sent,e.setState({userList:s.data});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this,t=this.state.selectedUser,a=t.activeIndex,n=t.name,r=t.dp,c=t.lastseen,o=this.state,i=o.chat,l=o.messages,d=o.userList.map((function(t,n){var r=a===n?"active":"";return Object(s.jsx)(D.a,{className:r,onClick:e.isActive.bind(e,n,t),children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"3",children:Object(s.jsx)("span",{className:"pull-left",children:Object(s.jsx)(x.a,{className:"dp",src:t.sImage})})}),Object(s.jsxs)(z.a,{md:"9",children:["".concat(t.sFirstName," ").concat(t.sLastName),Object(s.jsx)("br",{}),Object(s.jsx)("em",{style:{color:"black"},children:"@".concat(t.sUsername)})]})]})},t._id)}));return Object(s.jsx)("div",{children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"4",children:Object(s.jsx)(J.a,{className:"chat-card",children:Object(s.jsxs)(K.a,{children:[Object(s.jsx)(G.a,{tag:"h5",className:"mb-2 text-muted",children:"Users"}),Object(s.jsx)("br",{}),Object(s.jsx)(W.a,{className:"scroll",children:d})]})})}),Object(s.jsx)(z.a,{md:"8",children:Object(s.jsx)(J.a,{className:"chat-card",children:Object(s.jsxs)(K.a,{children:[Object(s.jsx)(G.a,{className:"text-muted",children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"1",children:Object(s.jsx)("span",{className:"pull-left",children:Object(s.jsx)(x.a,{className:"dp",src:r})})}),Object(s.jsx)(z.a,{md:"11",className:"pull-left",children:Object(s.jsxs)(Y.a,{children:[Object(s.jsx)(H.a,{children:n}),Object(s.jsx)(H.a,{children:c?Object(s.jsx)("small",{children:Object(s.jsxs)("em",{children:[" ","last seen "+X()(c).fromNow()]})}):Object(s.jsx)("span",{className:"m-auto",style:{fontSize:"20px"},children:"Click on user to start chat"})})]})})]})}),Object(s.jsx)("hr",{}),Object(s.jsxs)(W.a,{className:"scroll",style:{paddingBottom:"60px"},children:[l&&l.length>0?l.map((function(e,t){return localStorage.getItem("_id")===e.oFrom._id?Object(s.jsx)(D.a,{style:{border:"none"},children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"6"}),Object(s.jsx)(z.a,{md:"6",style:{textAlign:"end"},children:e.sMessage.includes("http://")?e.sMessage.includes(".mp4")?Object(s.jsx)("video",{src:e.sMessage,height:"100%",width:"100%",style:{padding:"8px"},controls:!0,autoPlay:!0,muted:!0}):Object(s.jsx)("img",{src:e.sMessage,height:"100%",width:"100%",alt:"",style:{borderRadius:"10px",padding:"8px"}}):Object(s.jsx)("span",{style:{backgroundColor:"#f7f7f7",borderColor:"#292b2c",borderRadius:"40px",padding:"8px"},children:e.sMessage})})]})},t):Object(s.jsx)(D.a,{style:{border:"none"},children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"6",style:{textAlign:"start"},children:e.sMessage.includes("http://")?e.sMessage.includes(".mp4")?Object(s.jsx)("video",{src:e.sMessage,height:"100%",width:"100%",style:{padding:"8px"},controls:!0,autoPlay:!0,muted:!0}):Object(s.jsx)("img",{src:e.sMessage,height:"100%",width:"100%",alt:"",style:{borderRadius:"10px",padding:"8px"}}):Object(s.jsx)("span",{style:{backgroundColor:"#f7f7f7",borderColor:"#292b2c",borderRadius:"40px",padding:"8px"},children:e.sMessage})}),Object(s.jsx)(z.a,{md:"6"})]})},t)})):null,Object(s.jsx)("div",{ref:function(t){e.messagesEnd=t},style:{float:"left",clear:"both"},children:" "})]}),0===a||a>=1?Object(s.jsx)(k.a,{className:"chat-form",onSubmit:this.sendMessage,children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"1",children:Object(s.jsxs)(T.a,{children:[Object(s.jsx)(F.a,{onClick:this.uploadButton,children:Object(s.jsx)("i",{className:"fa fa-camera","aria-hidden":"true"})}),Object(s.jsx)(E.a,{type:"file",id:"media",name:"media",accept:"image/*, video/*",style:{display:"none"},onChange:this.handleChange})]})}),Object(s.jsx)(z.a,{md:"10",children:Object(s.jsxs)(T.a,{style:{paddingLeft:"25px"},children:[Object(s.jsx)(E.a,{type:"text",id:"message",name:"message",onChange:this.handleChange,value:i.message,autoComplete:"off"}),Object(s.jsx)(L.a,{})]})}),Object(s.jsx)(z.a,{md:"1",children:Object(s.jsx)(T.a,{children:Object(s.jsx)(F.a,{color:"primary",disabled:!this.isMessageTyped(),children:Object(s.jsx)("i",{className:"fa fa-paper-plane","aria-hidden":"true"})})})})]})}):null]})})})]})})}}]),a}(n.Component),te=a(78),ae=a(486),se=a(487),ne=a(488),re=a(7),ce=a.n(re),oe=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).toggle=function(e){s.state.activeTab!==e&&s.setState({activeTab:e})},s.toggle=s.toggle.bind(Object(te.a)(s)),s.state={activeTab:"2"},s}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return Object(s.jsx)(H.a,{className:"justify-content-md-center",children:Object(s.jsxs)("div",{children:[Object(s.jsxs)(u.a,{tabs:!0,children:[Object(s.jsx)(f.a,{children:Object(s.jsx)(ae.a,{className:ce()({active:"1"===this.state.activeTab}),onClick:function(){e.toggle("1")},children:"Create your account"})}),Object(s.jsx)(f.a,{children:Object(s.jsx)(ae.a,{className:ce()({active:"2"===this.state.activeTab}),onClick:function(){e.toggle("2")},children:"Log in to Chat"})})]}),Object(s.jsxs)(se.a,{activeTab:this.state.activeTab,children:[Object(s.jsxs)(ne.a,{tabId:"1",children:[Object(s.jsx)("br",{}),Object(s.jsx)(H.a,{children:Object(s.jsx)(z.a,{md:12,children:Object(s.jsx)(J.a,{body:!0,children:"1"===this.state.activeTab?Object(s.jsx)(B,{}):null})})})]}),Object(s.jsxs)(ne.a,{tabId:"2",children:[Object(s.jsx)("br",{}),Object(s.jsx)(H.a,{children:Object(s.jsx)(z.a,{md:12,children:Object(s.jsx)(J.a,{body:!0,children:"2"===this.state.activeTab?Object(s.jsx)(M,{}):null})})})]})]})]})})}}]),a}(n.Component),ie=a(489),le=a(490),de=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).getInitialState=function(){return{user:{_id:"",eGender:"",sFirstName:"",sImage:"",sLastName:"",sUsername:"",createdAt:"",updatedAt:""},files:{dp:""},errors:{},response:{status:"",message:"",error:""}}},s.handleChange=function(e){s.setState({user:Object(I.a)(Object(I.a)({},s.state.user),{},Object(_.a)({},e.target.name,e.target.value)),errors:Object(I.a)(Object(I.a)({},s.state.errors),{},Object(_.a)({},e.target.name,"")),files:{dp:e.target.files[0]}})},s.validate=function(){var e=s.state.user,t={};return Object(R.isAlpha)(e.sFirstName)||(t.sFirstName="First name must only contain alphabets."),""===e.sFirstName&&(t.sFirstName="First name cannot be empty."),Object(R.isAlpha)(e.sLastName)||(t.sLastName="Last name must only contain alphabets."),""===e.sLastName&&(t.sLastName="Last name cannot be empty."),""===e.sUsername&&(t.sUsername="Username cannot be empty."),t},s.handleSubmit=function(e){e.preventDefault();var t=s.state.user,a=s.validate();if(0===Object.keys(a).length){var n=localStorage.getItem("token"),r={Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(n)},c={method:"PATCH",headers:new Headers(r),body:JSON.stringify({sFirstName:t.sFirstName,sLastName:t.sLastName,sUsername:t.sUsername})};fetch("".concat(P.REACT_APP_API_BASE_URL,"/user/update/").concat(t._id),c).then(function(){var e=Object(N.a)(A.a.mark((function e(a){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.json();case 2:n=e.sent,s.setState({user:t,response:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error: ",e)})),s.setState(s.getInitialState())}else s.setState({errors:a})},s.uploadProfilePic=function(){var e=s.state.files,t=localStorage.getItem("_id"),a=localStorage.getItem("token"),n=new FormData;n.append("_id",t),n.append("dp",e.dp);var r={Authorization:"Bearer ".concat(a)},c={method:"PATCH",headers:new Headers(r),body:n};fetch("".concat(P.REACT_APP_API_BASE_URL,"/user/upload/dp"),c).then((function(e){return window.location.reload()})).catch((function(e){console.log("error: ",e)})),s.setState(s.getInitialState())},s.uploadButton=function(){q()("input[type=file]").trigger("click")},s.isFileSelected=function(){var e=s.state.files.dp;return console.log(e),!!e},s.state=s.getInitialState(),s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=localStorage.getItem("_id"),a=localStorage.getItem("token"),s={Authorization:"Bearer ".concat(a)},n={method:"GET",headers:new Headers(s)};fetch("".concat(P.REACT_APP_API_BASE_URL,"/user/get?_id=").concat(t),n).then(function(){var t=Object(N.a)(A.a.mark((function t(a){var s;return A.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.json();case 2:s=t.sent,localStorage.setItem("dp",s.data.sImage),e.setState({user:s.data});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this.state,t=e.user,a=e.errors,n=e.response;return Object(s.jsx)("div",{children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(z.a,{md:"4",children:Object(s.jsxs)(J.a,{className:"edit-profile-card",style:{borderColor:"white"},children:[Object(s.jsx)(ie.a,{top:!0,width:"100%",src:t.sImage,alt:"Change your avatar",style:{borderRadius:"50%"}}),Object(s.jsx)("br",{}),Object(s.jsxs)(H.a,{className:"justify-content-center",children:[Object(s.jsxs)(z.a,{md:"5",children:[Object(s.jsx)(F.a,{color:"secondary",onClick:this.uploadButton,block:!0,children:"Choose"}),Object(s.jsx)(E.a,{type:"file",accept:"image/*",multiple:!1,style:{display:"none"},onChange:this.handleChange})]}),Object(s.jsx)(z.a,{md:"5",children:Object(s.jsx)(F.a,{color:"secondary",onClick:this.uploadProfilePic,block:!0,disabled:!this.isFileSelected(),children:"Upload"})})]}),Object(s.jsxs)(K.a,{children:[Object(s.jsx)(le.a,{tag:"h5",children:"".concat(t.sFirstName," ").concat(t.sLastName)}),Object(s.jsx)(G.a,{tag:"h6",className:"mb-2 text-muted",children:Object(s.jsxs)("i",{children:["@",t.sUsername]})}),Object(s.jsx)("br",{}),Object(s.jsxs)(le.a,{tag:"h6",children:["Joined ",X()(t.createdAt).fromNow()]})]})]})}),Object(s.jsx)(z.a,{md:"8",children:Object(s.jsx)(J.a,{className:"edit-profile-card",style:{borderColor:"white"},children:Object(s.jsxs)(K.a,{children:[Object(s.jsx)(le.a,{tag:"h5",className:"text-center text-muted",children:"Edit Profile"}),Object(s.jsxs)(k.a,{onSubmit:this.handleSubmit,children:[Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sFirstName",children:"First Name"}),Object(s.jsx)(E.a,{id:"sFirstName",name:"sFirstName",invalid:!!a.sFirstName,onChange:this.handleChange,value:t.sFirstName}),Object(s.jsx)(L.a,{})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sLastName",children:"Last Name"}),Object(s.jsx)(E.a,{id:"sLastName",name:"sLastName",invalid:!!a.sLastName,onChange:this.handleChange,value:t.sLastName}),Object(s.jsx)(L.a,{})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sUsername",children:"Username"}),Object(s.jsx)(E.a,{id:"sUsername",name:"sUsername",invalid:!!a.sUsername,onChange:this.handleChange,value:t.sUsername}),Object(s.jsx)(L.a,{})]}),Object(s.jsx)(T.a,{children:n.message?n.status>400?Object(s.jsx)("div",{className:"alert alert-danger",children:n.message}):Object(s.jsx)("div",{className:"alert alert-success",children:n.message}):null}),Object(s.jsx)(F.a,{color:"primary",className:"float-right",children:"Save Changes"})]})]})})})]})})}}]),a}(n.Component),je=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(e){var s;return Object(i.a)(this,a),(s=t.call(this,e)).getInitialState=function(){return{data:{sPassword:"",sConfirmPassword:""},errors:{},response:{status:"",message:"",error:""}}},s.handleChange=function(e){s.setState({data:Object(I.a)(Object(I.a)({},s.state.data),{},Object(_.a)({},e.target.name,e.target.value)),errors:Object(I.a)(Object(I.a)({},s.state.errors),{},Object(_.a)({},e.target.name,""))})},s.validate=function(){var e=s.state.data,t={};return e.sPassword.length<8&&(t.sPassword="Password must be atleast 8 characters."),""===e.sPassword&&(t.sPassword="Password cannot be empty."),e.sPassword!==e.sConfirmPassword&&(t.sConfirmPassword="Passwords doesn't match."),e.sConfirmPassword.length<8&&(t.sConfirmPassword="Password must be atleast 8 characters."),""===e.sConfirmPassword&&(t.sConfirmPassword="Password cannot be empty."),t},s.handleSubmit=function(e){e.preventDefault();var t=s.state.data,a=s.validate();if(0===Object.keys(a).length){delete t.sConfirmPassword;var n=localStorage.getItem("_id"),r=localStorage.getItem("token"),c={Accept:"application/json","Content-Type":"application/json;charset=UTF-8",Authorization:"Bearer ".concat(r)},o={method:"PUT",headers:new Headers(c),body:JSON.stringify({_id:n,sPassword:t.sPassword})};fetch("".concat(P.REACT_APP_API_BASE_URL,"/auth/reset/password"),o).then(function(){var e=Object(N.a)(A.a.mark((function e(t){var a;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:if(a=e.sent,s.setState({response:a}),200!==a.status){e.next=6;break}return e.abrupt("return",window.location.assign("/chat"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("error: ",e)})),s.setState(s.getInitialState())}else s.setState({errors:a})},s.state=s.getInitialState(),s}return Object(l.a)(a,[{key:"render",value:function(){var e=this.state,t=e.data,a=e.errors,n=e.response;return Object(s.jsx)(Y.a,{children:Object(s.jsx)(H.a,{className:"justify-content-md-center",children:Object(s.jsx)(z.a,{md:"4",children:Object(s.jsxs)(k.a,{onSubmit:this.handleSubmit,children:[Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sPassword",children:"Password"}),Object(s.jsx)(E.a,{id:"sPassword",name:"sPassword",type:"password",invalid:!!a.sPassword,onChange:this.handleChange,value:t.sPassword}),Object(s.jsx)(L.a,{children:a.sPassword})]}),Object(s.jsxs)(T.a,{children:[Object(s.jsx)(U.a,{for:"sConfirmPassword",children:"Confirm Password"}),Object(s.jsx)(E.a,{id:"sConfirmPassword",name:"sConfirmPassword",type:"password",invalid:!!a.sConfirmPassword,onChange:this.handleChange,value:t.sConfirmPassword}),Object(s.jsx)(L.a,{children:a.sConfirmPassword})]}),Object(s.jsx)(T.a,{children:n.message?n.status>400?Object(s.jsx)("div",{className:"alert alert-danger",children:n.message}):Object(s.jsx)("div",{className:"alert alert-success",children:n.message}):null}),Object(s.jsx)(T.a,{children:Object(s.jsx)(F.a,{color:"primary",block:!0,children:"ResetPassword"})})]})})})})}}]),a}(n.Component),he=a(221),me=a(17),ue=function(e){Object(d.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(i.a)(this,a);for(var s=arguments.length,n=new Array(s),r=0;r<s;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))).isAuth=function(){var e=localStorage.getItem("_id"),t=localStorage.getItem("token");return!(!e||!t)&&Object(v.verify)(t,P.REACT_APP_JWT_SECRET_KEY)._id===e},e}return Object(l.a)(a,[{key:"render",value:function(){return this.isAuth()?Object(s.jsxs)(Y.a,{children:[Object(s.jsx)(H.a,{children:Object(s.jsx)(z.a,{children:Object(s.jsx)(w,{})})}),Object(s.jsxs)(he.a,{children:[Object(s.jsx)(me.a,{path:"/chat",component:ee}),Object(s.jsx)(me.a,{path:"/profile",component:de}),Object(s.jsx)(me.a,{path:"/reset",component:je})]}),Object(s.jsx)(H.a,{children:Object(s.jsx)(z.a,{children:Object(s.jsx)(y,{})})})]}):Object(s.jsxs)(Y.a,{children:[Object(s.jsx)(H.a,{children:Object(s.jsx)(z.a,{children:Object(s.jsx)(w,{})})}),Object(s.jsx)(oe,{}),Object(s.jsx)(H.a,{children:Object(s.jsx)(z.a,{children:Object(s.jsx)(y,{})})})]})}}]),a}(n.Component);a(463),a(464);o.a.render(Object(s.jsx)(r.a.StrictMode,{children:Object(s.jsx)(ue,{})}),document.getElementById("root"))}},[[465,1,2]]]);
//# sourceMappingURL=main.2425c084.chunk.js.map